<ion-header>
  <ion-toolbar>
    <ion-title>Admin Dashboard</ion-title>
    <ion-buttons slot="end">
      <ion-button routerLink="/tabs/home">
        <ion-icon slot="icon-only" name="exit-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="refreshData($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  
  <div class="welcome-card">
    <h2>Welcome back, {{ currentUser?.name || 'Admin' }}!</h2>
    <p>Here's an overview of your pet shop</p>
  </div>
  
  <div *ngIf="loading" class="loading-container">
    <ion-spinner name="dots"></ion-spinner>
    <p>Loading dashboard data...</p>
  </div>
  
  <div *ngIf="!loading" class="dashboard-container">
    <div class="stats-grid">
      <div class="stat-card" (click)="navigateTo('users')" style="background-color: var(--ion-color-primary);">
        <ion-icon name="people"></ion-icon>
        <div class="stat-value">{{ stats.totalUsers }}</div>
        <div class="stat-label">Total Users</div>
      </div>
      
      <div class="stat-card" (click)="navigateTo('pets')" style="background-color: var(--ion-color-success);">
        <ion-icon name="paw"></ion-icon>
        <div class="stat-value">{{ stats.totalPets }}</div>
        <div class="stat-label">Total Pets</div>
      </div>
      
      <div class="stat-card" (click)="navigateTo('products')" style="background-color: var(--ion-color-tertiary);">
        <ion-icon name="cart"></ion-icon>
        <div class="stat-value">{{ stats.totalProducts }}</div>
        <div class="stat-label">Total Products</div>
      </div>
      
      <div class="stat-card" (click)="navigateTo('reports')" style="background-color: var(--ion-color-danger);">
        <ion-icon name="warning"></ion-icon>
        <div class="stat-value">{{ stats.pendingReports }}</div>
        <div class="stat-label">Pending Reports</div>
      </div>
      
      <div class="stat-card" (click)="navigateTo('pets')" style="background-color: var(--ion-color-warning);">
        <ion-icon name="heart"></ion-icon>
        <div class="stat-value">{{ stats.pendingAdoptions }}</div>
        <div class="stat-label">Pending Adoptions</div>
      </div>
      
      <div class="stat-card" (click)="navigateTo('messages')" style="background-color: var(--ion-color-secondary);">
        <ion-icon name="chatbubbles"></ion-icon>
        <div class="stat-value">{{ stats.unreadMessages }}</div>
        <div class="stat-label">Unread Messages</div>
      </div>
    </div>
    
    <div class="dashboard-section">
      <div class="section-header">
        <h3>Recent Pets</h3>
        <ion-button fill="clear" size="small" (click)="navigateTo('pets')">View All</ion-button>
      </div>
      
      <ion-list *ngIf="recentPets.length > 0">
        <ion-item *ngFor="let pet of recentPets" button>
          <ion-thumbnail slot="start" *ngIf="pet.imageUrl">
            <img [src]="pet.imageUrl" alt="{{ pet.name }}">
          </ion-thumbnail>
          <ion-icon *ngIf="!pet.imageUrl" slot="start" name="paw" size="large"></ion-icon>
          
          <ion-label>
            <h2>{{ pet.name }}</h2>
            <p>{{ pet.breed || pet.species }}</p>
            <p *ngIf="pet.age">{{ pet.age }} year(s) old</p>
          </ion-label>
          
          <ion-badge slot="end" color="{{ getStatusColor(pet.status) }}">
            {{ pet.status | titlecase }}
          </ion-badge>
        </ion-item>
      </ion-list>
      
      <div *ngIf="recentPets.length === 0" class="empty-state small">
        <p>No pets available</p>
      </div>
    </div>
    
    <div class="dashboard-section">
      <div class="section-header">
        <h3>Recent Reports</h3>
        <ion-button fill="clear" size="small" (click)="navigateTo('reports')">View All</ion-button>
      </div>
      
      <ion-list *ngIf="recentReports.length > 0">
        <ion-item *ngFor="let report of recentReports" button>
          <ion-icon slot="start" name="warning" color="danger"></ion-icon>
          
          <ion-label>
            <h2>{{ report.title }}</h2>
            <p>{{ report.description | slice:0:50 }}{{ report.description.length > 50 ? '...' : '' }}</p>
            <p>Reported on: {{ getFormattedDate(report.createdAt) }}</p>
          </ion-label>
          
          <ion-badge slot="end" color="{{ getStatusColor(report.status) }}">
            {{ report.status | titlecase }}
          </ion-badge>
        </ion-item>
      </ion-list>
      
      <div *ngIf="recentReports.length === 0" class="empty-state small">
        <p>No reports available</p>
      </div>
    </div>
  </div>
</ion-content>
