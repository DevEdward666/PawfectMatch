<ion-header>
  <ion-toolbar>
    <ion-title>
      Adoptable Pets
    </ion-title>
  </ion-toolbar>
  <ion-toolbar>
    <ion-searchbar placeholder="Search pets" [(ngModel)]="searchTerm" (ionChange)="onSearchChange($event)"></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="refreshPets($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  
  <div class="filters-container">
    <ion-item>
      <ion-label>Status</ion-label>
      <ion-select [(ngModel)]="selectedStatus" (ionChange)="onStatusChange($event)" interface="popover">
        <ion-select-option value="">All</ion-select-option>
        <ion-select-option *ngFor="let status of statuses" [value]="status">
          {{ status | titlecase }}
        </ion-select-option>
      </ion-select>
    </ion-item>
    
    <ion-item>
      <ion-label>Species</ion-label>
      <ion-select [(ngModel)]="selectedSpecies" (ionChange)="onSpeciesChange($event)" interface="popover">
        <ion-select-option value="">All</ion-select-option>
        <ion-select-option *ngFor="let type of species" [value]="type">
          {{ type | titlecase }}
        </ion-select-option>
      </ion-select>
    </ion-item>
    
    <ion-button expand="block" fill="clear" (click)="resetFilters()">
      Clear Filters
    </ion-button>
  </div>
  
  <div *ngIf="loading" class="loading-container">
    <ion-spinner name="dots"></ion-spinner>
    <p>Loading pets...</p>
  </div>
  
  <div *ngIf="!loading && filteredPets.length === 0" class="empty-state">
    <ion-icon name="paw-outline"></ion-icon>
    <h3>No pets found</h3>
    <p>Try adjusting your filters or check back later for new pets</p>
  </div>
  
  <div class="pet-grid">
    <ion-card *ngFor="let pet of filteredPets" class="pet-card" (click)="navigateToPetDetail(pet.id)">
      <div class="pet-image">
        <img [src]="pet.imageUrl || 'assets/pet-placeholder.svg'" alt="{{ pet.name }}">
        <div class="status-badge" [ngClass]="pet.status">{{ pet.status }}</div>
      </div>
      
      <ion-card-header>
        <ion-card-title>{{ pet.name }}</ion-card-title>
        <ion-card-subtitle>{{ pet.breed || pet.species }}</ion-card-subtitle>
      </ion-card-header>
      
      <ion-card-content>
        <div class="pet-attributes">
          <div class="attribute">
            <ion-icon name="calendar-outline"></ion-icon>
            <span>{{ pet.age || 'Unknown' }} {{ pet.age === 1 ? 'year' : 'years' }}</span>
          </div>
          
          <div class="attribute">
            <ion-icon name="male-female-outline"></ion-icon>
            <span>{{ pet.gender || 'Unknown' }}</span>
          </div>
        </div>
        
        <p *ngIf="pet.description" class="pet-description">{{ pet.description | slice:0:60 }}{{ pet.description.length > 60 ? '...' : '' }}</p>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
